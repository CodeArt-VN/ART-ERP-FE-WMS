<ion-header>
	<app-toolbar [page]="this" pageTitle="{{'Item detail in branch' | translate}}" [pageConfig]="pageConfig" [selectedItems]="selectedItems" (refresh)="refresh()" (help)="help()">
		<ion-buttons *ngIf="segmentView.Page == 'Inventory'">
			<ion-button (click)="isAdjust = !isAdjust">
				<label> {{ 'Điều chỉnh' | translate }}</label>
			</ion-button>
			<ion-button (click)="createAdjust()">
				<label> {{ 'Tạo điều chỉnh' | translate }}</label>
			</ion-button>
		</ion-buttons>
	</app-toolbar>
	<div class="withFeature left" [ngClass]="{withFeature: pageConfig.isShowFeature}" *ngIf="pageConfig.isShowSearch">
		<section class="table">
			<header class="bold">
				<div class="col-checkbox cell"></div>
				<div class="col-name cell">
					{{'Search info' | translate}}
					<ion-icon class="min-btn" (click)="pageConfig.isShowSearch = !pageConfig.isShowSearch" *ngIf="optionQuery.Keyword" name="search" color="primary"></ion-icon>
				</div>
			</header>
			<form (submit)="preLoadData(null)" action="#">
				<header class="filter">
					<div class="col-checkbox cell"></div>
					<div class="cell">
						<input [ngModelOptions]="{standalone: true}" [(ngModel)]="optionQuery.Keyword" class="c-input" [ngClass]="{active: optionQuery.Keyword}" type="text" />
						<ion-icon class="min-btn" (click)="optionQuery.Keyword=''; preLoadData(null)" *ngIf="optionQuery.Keyword" name="close-circle-outline"></ion-icon>
					</div>
					<button mat-raised-button type="submit" style="display: none">Search</button>
				</header>
			</form>
		</section>
	</div>
</ion-header>

<ion-content appScrollbarTheme class="left" [ngClass]="{withFeature: pageConfig.isShowFeature}" forceOverscroll="false">
	<ion-fab
		*ngIf="pageConfig.isShowFeature"
		[ngClass]="{withSearch: pageConfig.isShowSearch,'ion-hide-md-down': pageConfig.isSubActive}"
		class="feature no-print"
		vertical="bottom"
		horizontal="start"
		slot="fixed"
	>
		<app-page-message [itemsLength]="1" [showSpinner]="pageConfig.showSpinner"></app-page-message>
		<div *ngIf="pageConfig.showSpinner==false">
			<div class="ion-padding" style="padding-bottom: 0">
				<div class="c-control" *ngIf="formGroup.get('Id').value>0">
					<app-form-control
						[field]="{branchConfig:{selectedBranch:this.formGroup.get('IDBranch').value, showingMode:'showSelectedAndChildren'},
            id: 'IDBranchItemInBranch', label: 'Branch', type: 'ng-select-branch',dataSource:branchList, form: formGroup,bindLabel:'Name',bindValue:'Id',clearable:true}"
						(controlChange)="changeIDBranchItemInBranch($event)"
					>
					</app-form-control>
				</div>
			</div>
			<div>
				<ion-list-header lines="full">
					<ion-label color="dark">{{'Information' | translate}}</ion-label>
				</ion-list-header>
				<ion-list>
					<ng-container *ngFor="let i of optionGroup">
						<ion-item
							*ngIf="(formGroup.get('IsInventoryItem').value && i.Code =='Inventory') || i.Code !='Inventory' "
							[color]="segmentView.Page == i.Code? 'primary': '' "
							button
							detail="true"
							lines="full"
							class="clickable"
							(click)="loadNode(i)"
						>
							<ion-label class="ion-text-wrap">
								<h3>{{i.Name}}</h3>
							</ion-label>
						</ion-item>
					</ng-container>
				</ion-list>
			</div>
			<div class="ion-padding" style="padding-bottom: 0"></div>
		</div>
	</ion-fab>
	<ion-grid fixed class="grid-parent">
		<ion-row>
			<ion-col size="12">
				<div class="ion-padding" style="min-width: 300px">
					<app-page-title class="ion-margin-bottom" *ngIf="selectedOption" icon="cog-outline" color="primary" [title]="selectedOption.Name"> </app-page-title>
					<div id="ng-select-header" style="position: absolute; z-index: 30005"></div>
					<app-page-message [itemsLength]="1" [showSpinner]="pageConfig.showSpinner"></app-page-message>
					<div class="main-view" *ngIf="pageConfig?.showSpinner == false">
						<div class="row-full shadow full-screen ion-padding">
							<ion-grid fixed class="grid-child">
								<div>
									<div id="generalInformation" *ngIf="segmentView.Page == 'GeneralInformation'">
										<div class="ion-padding">
											<ion-grid fixed>
												<form [formGroup]="formGroup">
													<ion-row class="hr-group">
														<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Product information' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-md="12" size-lg="12" size-xl="6">
															<div class="c-control">
																<label class="c-label" for="Id">Id</label>
																<input class="c-input" readonly id="Id" formControlName="Id" type="number" />
															</div>
															<app-form-control [field]="{id: 'Code', type: 'text', form: formGroup }" (change)="saveChange()">
																<small label>{{'from vendor' | translate}}</small>
															</app-form-control>

															<app-form-control [field]="{id: 'Name', type: 'text', form: formGroup }" (change)="saveChange()"> </app-form-control>

															<app-form-control
																[field]="{id: 'ForeignName', label: 'English name', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																*ngIf="pageConfig.canChangeBranch"
																[field]="{id: 'IDBranch', label: 'Branch', type: 'ng-select-branch',dataSource:branchList, form: formGroup,bindLabel:'Name',bindValue:'Id',clearable:true}"
																(controlChange)="changeIDBranch($event)"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Expiry', label: 'Shelf life from manufactured date', type: 'number', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'ExpiryUnit', label: 'Unit', type: 'select', form: formGroup,  dataSource: ExpiryUnitList,  bindLabel: 'Name',  bindValue: 'Code' }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'IsInventoryItem', label: 'Goods for storage', type: 'checkbox', form: formGroup }"
																(change)="branchSelected ? saveItemInBranch() : saveChange()"
															>
															</app-form-control>
															<app-form-control
																[field]="{id: 'IsSalesItem', label: 'Goods for sale', type: 'checkbox', form: formGroup }"
																(change)="branchSelected ? saveItemInBranch() : saveChange()"
															>
															</app-form-control>
															<app-form-control
																[field]="{id: 'IsPurchaseItem', label: 'Goods to order', type: 'checkbox', form: formGroup }"
																(change)="branchSelected ? saveItemInBranch() : saveChange()"
															>
															</app-form-control>
															<div class="c-control">
																<input
																	[readonly]="!(pageConfig.canEdit || pageConfig.canAdd)"
																	(change)="saveChange()"
																	class="c-checkbox"
																	id="IsDisabled"
																	formControlName="IsDisabled"
																	type="checkbox"
																/>
																<label class="c-label checkbox" for="IsDisabled"
																	>{{'Sản phẩm đã ngưng sử dụng' | translate}}
																	<span
																		*ngIf="!formGroup.controls.IsDisabled.valid && !formGroup.controls.IsDisabled.pending && (formGroup.controls.IsDisabled.dirty || submitAttempt)"
																		ion-text
																		color="danger"
																		>(*)</span
																	>
																</label>
															</div>
														</ion-col>
													</ion-row>

													<ion-row class="hr-group">
														<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Vendor' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-md="12" size-lg="12" size-xl="6">
															<app-form-control
																[field]="{id: 'VendorIds', label: 'Select Vendor', type: 'ng-select-bp', form: formGroup,  dataSource: _vendorDataSource,  bindLabel: 'Name',  bindValue: 'Id', multiple: true,clearable:true, appendTo:'#ng-select-header' }"
																(change)="_vendorDataSource.addSelectedItem($event);saveChange()"
															>
															</app-form-control>
														</ion-col>
													</ion-row>

													<ion-row class="hr-group">
														<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Products classification' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-md="12" size-lg="12" size-xl="6">
															<app-form-control
																[field]="{id: 'IDItemGroup', label: 'Belonged to group', type: 'ng-select', form: formGroup,  dataSource: itemGroupList,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header',
                                  treeConfig:{searchFnDefault:true,isTree:true, isCollapsed:true}}"
																(change)="branchSelected ? saveItemInBranch() : saveChange();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'ItemType', label: 'Product type', type: 'ng-select', form: formGroup,  dataSource: ItemTypeList,  bindLabel: 'Name',  bindValue: 'Code', appendTo:'#ng-select-header' ,
                                treeConfig:{searchFnDefault:true,isTree:true,isCollapsed : true}}"
																(change)="branchSelected ? saveItemInBranch() : saveChange();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'IDCartonGroup', label: 'Carton group', type: 'ng-select', form: formGroup,  dataSource: cartonGroupList,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																(change)="branchSelected ? saveItemInBranch() : saveChange();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Industry', label: 'Industry', type: 'ng-select', form: formGroup,  dataSource: IndustryList,  bindLabel: 'Name',  bindValue: 'Code', appendTo:'#ng-select-header' }"
																(change)="branchSelected ? saveItemInBranch() : saveChange();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Division', label: 'Division', type: 'ng-select', form: formGroup,  dataSource: DivisionList,  bindLabel: 'Name',  bindValue: 'Code', appendTo:'#ng-select-header' }"
																(change)="branchSelected ? saveItemInBranch() : saveChange();"
															>
															</app-form-control>
														</ion-col>
													</ion-row>

													<ion-row class="hr-group">
														<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Tax' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-md="12" size-lg="12" size-xl="6">
															<app-form-control
																[field]="{id: 'IDSalesTaxDefinition', label: 'Sales Tax', type: 'ng-select', form: formGroup,  dataSource: outputTaxList,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																(change)="branchSelected ? saveItemInBranch() : saveChange();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'IDPurchaseTaxDefinition', label: 'Purchase Tax', type: 'ng-select', form: formGroup,  dataSource: inputTaxList,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																(change)="branchSelected ? saveItemInBranch() : saveChange();"
															>
															</app-form-control>
														</ion-col>
													</ion-row>

													<ion-row class="hr-group">
														<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Serial number' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-md="12" size-lg="12" size-xl="6" class="ion-no-padding">
															<app-form-control
																[field]="{id: 'SerialNumberStart', label: 'Start', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'SerialNumberEnd', label: 'End', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'SerialNumberNext', label: 'Next', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>
														</ion-col>
													</ion-row>

													<ion-row class="hr-group">
														<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Lottable' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-md="12" size-lg="12" size-xl="6">
															<app-form-control
																[field]="{id: 'Lottable0', label: 'Lottable0', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable1', label: 'Lottable1', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable2', label: 'Lottable2', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable3', label: 'Lottable3', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable4', label: 'Lottable4', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable5', label: 'Lottable5', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable6', label: 'Lottable6', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable7', label: 'Lottable7', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable8', label: 'Lottable8', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'Lottable9', label: 'Lottable9', type: 'text', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>
														</ion-col>
													</ion-row>
													<ion-row class="hr-group">
														<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'TI-HI' | translate}}</ion-label>
															</ion-list-header>
															<ion-item class="ion-no-padding" lines="none">
																<ion-label color="medium" class="ion-text-wrap">
																	<ul>
																		<!-- <li>Std Cost: Giá thành định mức</li> -->
																		<li>
																			{{'TI x HI = No. of boxes / pallet' | translate}}
																			<ul>
																				<li>{{'TI - Boxes /Tie' | translate}}</li>
																				<li>{{'HI: Number of stack (High)' | translate}}</li>
																			</ul>
																		</li>
																	</ul>
																</ion-label>
															</ion-item>
														</ion-col>
														<ion-col size="12" size-md="12" size-lg="12" size-xl="6">
															<app-form-control
																[field]="{id: 'TI', label: 'TI - Boxes /Tie', type: 'number', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>
															<app-form-control
																[field]="{id: 'HI', label: 'HI - Number of stack', type: 'number', form: formGroup }"
																(change)="saveChange()"
															>
															</app-form-control>
														</ion-col>
													</ion-row>
													<!-- Other information -->
													<ion-row class="hr-group" *ngIf="item.Id || selectedBranch">
														<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Other information' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-md="12" size-lg="12" size-xl="6">
															<app-form-control [field]="{id: 'CreatedBy', type: 'text', label: 'Created by', form: formGroup }"></app-form-control>
															<app-form-control
																[field]="{id: 'CreatedDate', type: 'span-datetime', label: 'Created date', form: formGroup }"
															></app-form-control>
															<app-form-control
																[field]="{id: 'ModifiedBy', type: 'text', label: 'Last modified by', form: formGroup }"
															></app-form-control>
															<app-form-control
																[field]="{id: 'ModifiedDate', type: 'span-datetime', label: 'Last modified date', form: formGroup }"
															></app-form-control>

															<app-form-control
																[field]="{id:'IDBranch', type : 'branch-breadcrumbs', label: 'Branch', form : formGroup, dataSource:env.branchList }"
															></app-form-control>
															<app-form-control
																[field]="{id:'Remark', type : 'textarea', label: 'Remark', form : formGroup }"
																(change)="saveMasterDataOrItemInBranch()"
															></app-form-control>
														</ion-col>
													</ion-row>
												</form>
											</ion-grid>
										</div>
									</div>
									<div id="uom" *ngIf="segmentView.Page == 'UnitSpecification'">
										<div class="table-contain" id="unit-specification">
											<section class="table" style="min-width: 1320px">
												<header class="bold" style="padding-right: 0">
													<div class="col-checkbox cell">{{'Original unit' | translate}}</div>
													<div class="col-checkbox cell">{{'Lẻ KT' | translate}}</div>
													<div class="col-checkbox cell" *ngIf="formGroup.get('IsPurchaseItem').value" style="padding: 0 !important">
														{{'Purchase' | translate}}
													</div>
													<div class="col-checkbox cell" *ngIf="formGroup.get('IsInventoryItem').value">{{'warehousing' | translate}}</div>
													<div class="col-checkbox cell" *ngIf="formGroup.get('IsSalesItem').value">{{'Sales' | translate}}</div>
													<div class="col1 cell">{{'Cứ' | translate}}</div>
													<div class="col2 cell">{{'Unit' | translate}}</div>
													<div class="col3 cell">=</div>
													<div class="col4 cell">{{'Convert' | translate}}</div>
													<div class="col2 cell"></div>
													<div class="col5 cell" style="padding: 0 !important">{{'Length (cm)' | translate}}</div>
													<div class="col6 cell">{{'Width' | translate}}</div>
													<div class="col7 cell">{{'High' | translate}}</div>
													<div class="col8 cell">{{'Weight (kg)' | translate}}</div>
													<div class="col2 cell">{{'Barcode' | translate}}</div>
													<div class="col3 cell" *ngIf="pageConfig.canDeleteUoM && pageConfig.canEditTrans"></div>
												</header>
												<div class="row" [ngClass]="{odd: j % 2 != 0 }" *ngFor="let i of formGroup.get('ItemUoMs')['controls']; let j = index;">
													<ng-container [formGroup]="i">
														<div class="col-checkbox cell">
															<ion-checkbox
																*ngIf="i.get('Id').value"
																[checked]="i.controls['IsBaseUoM'].value"
																(ionChange)="changeBaseUoM(i)"
																formControlName="IsBaseUoM"
															></ion-checkbox>
														</div>
														<div class="col-checkbox cell">
															<ion-checkbox
																*ngIf="i.get('Id').value"
																[checked]="i.controls['IsBaseUoM'].value"
																(ionChange)="changeBaseUoM(i)"
																formControlName="IsBaseUoM"
															></ion-checkbox>
														</div>
														<div class="col-checkbox cell" *ngIf="formGroup.get('IsPurchaseItem').value">
															<ion-checkbox
																(ionChange)="changeFGUoM($event,i,'PurchasingUoM')"
																[disabled]="!pageConfig.canEditUoM || submitAttempt || formGroup.get('PurchasingUoM').value == i.get('Id').value || !i.get('Id').value"
																[checked]="formGroup.get('PurchasingUoM').value == i.get('Id').value"
															></ion-checkbox>
														</div>

														<div class="col-checkbox cell" *ngIf="formGroup.get('IsInventoryItem').value">
															<ion-checkbox
																[disabled]="!pageConfig.canEditUoM || submitAttempt || formGroup.get('InventoryUoM').value ==i.get('Id').value|| !i.get('Id').value"
																(ionChange)="changeFGUoM($event,i,'InventoryUoM')"
																[checked]="formGroup.get('InventoryUoM').value ==i.get('Id').value"
															>
															</ion-checkbox>
														</div>

														<div class="col-checkbox cell" *ngIf="formGroup.get('IsSalesItem').value">
															<ion-checkbox
																(ionChange)="changeFGUoM($event,i,'SalesUoM')"
																[disabled]="!pageConfig.canEditUoM || submitAttempt || formGroup.get('SalesUoM').value == i.get('Id').value|| !i.get('Id').value"
																[checked]="formGroup.get('SalesUoM').value == i.get('Id').value"
															></ion-checkbox>
														</div>

														<div class="col1 cell">
															<app-input-control
																*ngIf="!i.get('IsBaseUoM').value"
																[field]="{id:'AlternativeQuantity',label:'Alternative quantity',type:'number',form:i}"
																(change)="saveUoM(i)"
															></app-input-control>
														</div>

														<div class="col2 cell">
															<app-input-control
																(change)="changedUoM($event, i)"
																[field]="{id:'Name',label:'unit',type:'ng-select',dataSource: uomList,bindLabel:'Name',bindValue:'Name',form:i, clearable:false,placeholder:'Unit'}"
															></app-input-control>
														</div>
														<div class="col3 cell">
															<span *ngIf="!i.get('IsBaseUoM').value">=</span>
														</div>
														<div class="col4 cell">
															<app-input-control
																*ngIf="!i.get('IsBaseUoM').value"
																[field]="{id:'BaseQuantity',label:'Base quantity',type:'number',form:i}"
																(change)="saveUoM(i)"
															></app-input-control>
														</div>
														<div class="col2 cell">
															<span *ngIf="!i.get('IsBaseUoM').value">{{baseUomName}}</span>
														</div>

														<div class="col5 cell">
															<app-input-control
																*ngIf="i.get('Id').value"
																[field]="{id:'Length',label:'Length',type:'number',form:i}"
																(change)="saveUoM(i)"
															></app-input-control>
														</div>

														<div class="col6 cell">
															<app-input-control
																*ngIf="i.get('Id').value"
																[field]="{id:'Width',label:'Width',type:'number',form:i}"
																(change)="saveUoM(i)"
															></app-input-control>
														</div>

														<div class="col7 cell">
															<app-input-control
																*ngIf="i.get('Id').value"
																[field]="{id:'Height',label:'Height',type:'number',form:i}"
																(change)="saveUoM(i)"
															></app-input-control>
														</div>
														<div class="col8 cell">
															<app-input-control
																*ngIf="i.get('Id').value"
																[field]="{id:'Weight',label:'Weight',type:'number',form:i}"
																(change)="saveUoM(i)"
															></app-input-control>
														</div>

														<div class="col2 cell">
															<app-input-control
																*ngIf="i.get('Id').value"
																[field]="{id:'Barcode',label:'Barcode',type:'number',form:i}"
																(change)="saveUoM(i)"
															></app-input-control>
														</div>
														<div class="col3 cell" *ngIf="pageConfig.canDeleteUoM && pageConfig.canEditTrans">
															<ion-icon color="danger" (click)="deleteUoM(i)" class="min-btn" name="trash-outline"></ion-icon>
														</div>
													</ng-container>
												</div>
											</section>
											<div class="row" *ngIf="(pageConfig.canAddUoM && pageConfig.canEditTrans && this.formGroup.get('ItemUoMs').valid) && this.id">
												<div class="cell">
													<ion-button fill="clear" size="small" (click)="checkingUoMBeforeAdd()">
														<ion-icon slot="start" name="add-circle-outline"></ion-icon>
														{{'Add unit' | translate}}
													</ion-button>
												</div>
											</div>
										</div>
									</div>
									<div id="price" *ngIf="segmentView.Page == 'UnitPrice'">
										<ion-grid fixed>
											<ion-row>
												<ion-col size="12">
													<div class="table-contain">
														<section class="table" style="min-width: 700px">
															<ng-container *ngFor="let i of priceList; let j = index;">
																<header class="bold" style="padding: 0">
																	<div class="col-id cell">
																		<a [routerLink]="['/price-list/'+i.Id]">{{i.Id}}</a>
																	</div>
																	<div class="col-item cell">{{i.Name}}</div>
																	<div class="col-uom cell">{{'Unit' | translate}}</div>
																	<div class="col-price cell">{{i.PrimaryDefaultCurrency}}</div>
																	<div class="col-price cell">{{i.PrimaryDefaultCurrency1}}</div>
																	<div class="col-price cell">{{i.PrimaryDefaultCurrency2}}</div>
																	<div class="col-id cell" *ngIf="pageConfig.canEditPrice"></div>
																	<div class="col-id cell" *ngIf="pageConfig.canEditPrice"></div>
																</header>
																<div class="row" [ngClass]="{border_: k==0 }" *ngFor="let p of i.Prices; let k = index;">
																	<div class="col-id cell"></div>
																	<div class="col-item cell"></div>
																	<div class="col-uom cell">
																		<ion-text color="primary"><b>{{p._UoM.Name}}</b></ion-text>
																	</div>
																	<div class="col-price cell">
																		<span *ngIf="!p.Id">-</span
																		><input
																			*ngIf="p.Id"
																			class="c-input"
																			[disabled]="!pageConfig.canEditPrice || !p.IsManual"
																			(change)="savePriceDetail(p)"
																			mask="separator.4"
																			thousandSeparator=","
																			[allowNegativeNumbers]="false"
																			type="tel"
																			[(ngModel)]="p.Price"
																		/>
																	</div>
																	<div class="col-price cell">
																		<span *ngIf="!p.Id">-</span
																		><input
																			*ngIf="p.Id"
																			class="c-input"
																			[disabled]="!pageConfig.canEditPrice || !p.IsManual"
																			(change)="savePriceDetail(p)"
																			mask="separator.4"
																			thousandSeparator=","
																			[allowNegativeNumbers]="false"
																			type="tel"
																			[(ngModel)]="p.Price1"
																		/>
																	</div>
																	<div class="col-price cell">
																		<span *ngIf="!p.Id">-</span
																		><input
																			*ngIf="p.Id"
																			class="c-input"
																			[disabled]="!pageConfig.canEditPrice || !p.IsManual"
																			(change)="savePriceDetail(p)"
																			mask="separator.4"
																			thousandSeparator=","
																			[allowNegativeNumbers]="false"
																			type="tel"
																			[(ngModel)]="p.Price2"
																		/>
																	</div>
																	<div class="col-id cell" (click)="changeManualPrice(p)" *ngIf="pageConfig.canEditPrice">
																		<ion-icon
																			[color]="p.IsManual?'danger':'success'"
																			class="min-btn"
																			[name]="p.Id? (p.IsManual?'lock-open':'lock-closed') : 'pencil'"
																		></ion-icon>
																	</div>
																	<div class="col-id cell" *ngIf="pageConfig.canEditPrice">
																		<ion-icon
																			color="danger"
																			class="min-btn"
																			name="trash-outline"
																			*ngIf="p.Id"
																			(click)="deletePriceDetail(p)"
																		></ion-icon>
																	</div>
																</div>
																<div class="ion-padding"></div>
															</ng-container>
														</section>
													</div>
												</ion-col>
											</ion-row>
										</ion-grid>
									</div>
									<div id="pictures" *ngIf="segmentView.Page == 'Pictures'">
										<div class="ion-padding">
											<ion-grid fixed>
												<ion-row>
													<ion-col size="12" size-sm="6" size-md="6" size-lg="4" size-xl="3" *ngFor="let i of item.ItemUoMs; let j = index;">
														<div class="image-box">
															<img class="img" [src]="i.Image" (error)="img.src = 'assets/undraw_no_data_qbuo.svg'" #img />

															<div class="image-title">{{i.Name}}</div>
														</div>
													</ion-col>
												</ion-row>
											</ion-grid>
										</div>
									</div>
									<div id="goodsOwner" *ngIf="segmentView.Page == 'GoodsOwner'">
										<div class="ion-padding">
											<ion-grid fixed>
												<form [formGroup]="formGroup">
													<ng-container formArrayName="WMS_ItemInWarehouseConfig">
														<ion-row class="hr-group" *ngFor="let config of formGroup.get('WMS_ItemInWarehouseConfig')['controls']; let i=index">
															<ng-container [formGroup]="config">
																<ion-col size="12" size-md="12" size-lg="12" size-xl="4">
																	<ion-list-header class="ion-no-padding">
																		<ion-label color="primary" style="max-width: 150px"
																			>{{'Warehouse arrangement' | translate}} {{i+1}}</ion-label
																		>
																		<ion-button color="danger" (click)="$event.stopPropagation();removeStorer(i)">
																			<ion-icon slot="icon-only" name="trash"></ion-icon>
																		</ion-button>
																	</ion-list-header>
																</ion-col>
																<ion-col size="12" size-md="12" size-lg="12" size-xl="6">
																	<app-form-control
																		[field]="{id: 'IDBranch', label: 'Warehouse', type: 'ng-select-branch', form: config,  dataSource: branchInWarehouse,  bindLabel: 'Name',  bindValue: 'Id',
                                    branchConfig:{showingType:'Warehouse'},
                                    treeConfig:{searchFnDefault:true}, appendTo:'#ng-select-header'}"
																		(controlChange)="changeBranchInWarehouse(config);"
																	>
																	</app-form-control>
																	<app-form-control
																		[field]="{id: 'IDStorer', label: 'Goods owner', type: 'ng-select', form: config,  dataSource: storerList,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'PutawayZone', label: 'Putaway zone', type: 'ng-select', form: config,  dataSource: config.get('_zoneList').value,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'Rotation', label: 'Rotation', type: 'ng-select', form: config,  dataSource: RotationList,  bindLabel: 'Name',  bindValue: 'Code', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'RotateBy', label: 'RotateBy', type: 'ng-select', form: config,  dataSource: RotateByList,  bindLabel: 'Name',  bindValue: 'Code', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'MaxPalletsPerZone', label: 'Max pallets/Zone', type: 'text', form: config }"
																		(change)="saveChange()"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'StackLimit', label: 'StackLimit', type: 'number', form: config }"
																		(change)="saveChange()"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'PutawayStrategy', label: 'Arrange goods into warehouse', type: 'ng-select', form: config,  dataSource:config.get('_putawayStrategyList').value,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'AllocationStrategy', label: 'Goods pick-up assignment', type: 'ng-select', form: config,  dataSource: config.get('_allocationStrategyList').value,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'PutawayLocation', label: 'PutawayLocation', type: 'ng-select', form: config,  dataSource: config.get('_locationList').value,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'InboundQCLocation', label: 'Inbound QC location', type: 'ng-select', form: config,  dataSource: config.get('_locationList').value,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'ReturnLocation', label: 'Return location', type: 'ng-select', form: config,  dataSource: config.get('_locationList').value,  bindLabel: 'Name',  bindValue: 'Id', appendTo:'#ng-select-header' }"
																		(change)="saveChange();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'MinimumInventoryLevel', label: 'Min inventory', type: 'number', form: config }"
																		(change)="saveChange()"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'MaximumInventoryLevel', label: 'Max inventory', type: 'number', form: config }"
																		(change)="saveChange()"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'IsAllowConsolidation', label: 'Allow to gather LCL goods', type: 'checkbox', form: config }"
																		(change)="saveChange()"
																	>
																	</app-form-control>
																</ion-col>
															</ng-container>
														</ion-row>
													</ng-container>
												</form>
												<ion-row class="hr-group" *ngIf="this.id && formGroup.get('WMS_ItemInWarehouseConfig').valid">
													<ion-col size="12" size-md="12" size-lg="12" size-xl="4" offset-xl="4">
														<ion-button [disabled]="!(pageConfig.canEdit || pageConfig.canAdd)" (click)="addConfig({})">
															{{'Add goods owner' | translate}}
														</ion-button>
													</ion-col>
												</ion-row>
											</ion-grid>
										</div>
									</div>
									<div id="planningData" *ngIf="segmentView.Page == 'PlanningData'">
										<div class="ion-padding">
											<ion-grid fixed>
												<form [formGroup]="formGroup">
													<ion-row class="hr-group">
														<ion-col size="12" size-sm="12" size-md="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Inventory data' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-sm size-xl="6">
															<app-form-control
																[field]="{id: 'InventoryLevelRequired', label: 'Required (Purchasing UoM)', type: 'number', form: formGroup }"
																(change)="saveItemInBranch()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'InventoryLevelMinimum', label: 'Minimum', type: 'number', form: formGroup }"
																(change)="saveItemInBranch()"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'InventoryLevelMaximum', label: 'Maximum', type: 'number', form: formGroup }"
																(change)="saveItemInBranch()"
															>
															</app-form-control>
														</ion-col>
													</ion-row>
													<ion-row class="hr-group">
														<ion-col size="12" size-sm="12" size-md="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Planning data' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-sm size-xl="6">
															<app-form-control
																[field]="{id: 'PlanningMethod', label: 'Planning Method', type: 'ng-select', form: formGroup,  dataSource: PlanningMethodList,  bindLabel: 'Name',  bindValue: 'Code', placeholder:'Search', appendTo:'#ng-select-header'}"
																(controlChange)="saveItemInBranch();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'ProcurementMethod', label: 'Procurement Method', type: 'ng-select', form: formGroup,  dataSource: ProcurementMethodList,  bindLabel: 'Name',  bindValue: 'Code', placeholder:'Search', appendTo:'#ng-select-header'}"
																(controlChange)="saveItemInBranch();"
															>
															</app-form-control>
															
															<app-form-control (change)="saveItemInBranch()" [field]="{id:'OrderInterval', label: 'Order interval', type : 'ng-select-async', dataSource: _orderIntervalDataSource, bindLabel: 'Name', bindValue: 'Name', form: formGroup}">

															</app-form-control>

															<app-form-control
																[field]="{id: 'OrderMultiple', label: 'Order Multiple', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'MinimumOrderQty', label: 'Minimum Order Qty', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'CheckingRule', label: 'Checking Rule', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'LeadTime', label: 'Lead Time', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'ToleranceDays', label: 'Tolerance Days', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>
														</ion-col>
													</ion-row>
													<ion-row class="hr-group">
														<ion-col size-sm="12" size-md="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Vendor planning data' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size-sm="12" size-md="12" size-xl="6">
															<!-- <ion-row>
																<ion-col size="12" size-sm size-xl="12">
																	<app-form-control
																		[field]="{id: 'OrderMultiple', label: 'Order Multiple', type: 'number', form: formGroup}"
																		(change)="saveItemInBranch();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'MinimumOrderQty', label: 'Minimum Order Qty', type: 'number', form: formGroup}"
																		(change)="saveItemInBranch();"
																	>
																	</app-form-control>
																	<app-form-control
																		[field]="{id: 'LeadTime', label: 'Lead Time', type: 'number', form: formGroup}"
																		(change)="saveItemInBranch();"
																	>
																	</app-form-control>

																	<app-form-control
																		[field]="{id: 'ToleranceDays', label: 'Tolerance Days', type: 'number', form: formGroup}"
																		(change)="saveItemInBranch();"
																	>
																	</app-form-control>
																</ion-col>
																
															</ion-row> -->
															<ion-row>
																<ion-col size="12" size-sm size-xl="12">
																	<div class="table-contain">
																		<app-data-table
																			class="box-shadow responsive"
																			[rows]="itemsPlaningData"
																			[trackBy]="'Id'"
																			[(selectedRows)]="selectedItems"
																			[showSpinner]="pageConfig.showSpinner"
																			[showFilter]="pageConfig.isShowSearch"
																			[(query)]="query"
																			(dataInfinite)="loadData($event)"
																			(filter)="onDatatableFilter($event)"
																			(sort)="onSort($event)"
																			(selectedRowsChange)="showCommandBySelectedRows($event)"
																		>
																			<datatable-empty-message
																				subMessage="Please click add new to start..."
																				[showImg]="false"
																				minHeight="125px"
																			>
																				<ng-template datatable-empty-message-template>
																					<ion-button
																						(click)="addPlanningVendor()"
																						size="small"
																						fill="outline"
																						*ngIf="pageConfig.canEdit"
																					>
																						<ion-icon slot="start" name="add-outline"></ion-icon>
																						{{ 'Add planning vendor' | translate }}
																					</ion-button>
																				</ng-template>
																			</datatable-empty-message>
																			<datatable-column [checkbox]="true" name=""></datatable-column>
																			<datatable-column
																				class="col-id"
																				name="IDVendor"
																				property="Id"
																				[navLink]="pageConfig.pageName"
																			></datatable-column>
																			<datatable-column class="col-name flex-break" name="Title" property="Id">
																				<ng-template let-i="row" datatable-cell-template>
																					<div *ngIf="i?._Vendor">{{i._Vendor.Name}}</div>
																				</ng-template>
																			</datatable-column>
																			<datatable-column class="col-code" name="Order interval" property="OrderInterval"></datatable-column>
																			<datatable-column class="col-code" name="Order multiple" property="OrderMultiple"></datatable-column>
																			<datatable-column class="col-code" name="Order multiple" property="OrderMultiple"></datatable-column>
																			<datatable-column class="col-code" name="MOQ" property="MinimumOrderQty"></datatable-column>
																			<datatable-column class="col-code" name="Lead time" property="LeadTime"></datatable-column>
																			<datatable-column class="col-code" name="Tolerance days" property="ToleranceDays"></datatable-column>
																		</app-data-table>
																	</div>
																</ion-col>
															</ion-row>
															<ion-row>
																<ion-col size="12" size-xl="12" *ngIf="itemsPlaningData.length && pageConfig.canEdit">
																	<div class="c-control">
																		<ion-button (click)="addPlanningVendor()" size="small" fill="outline">
																			<ion-icon slot="start" name="add-outline"></ion-icon>
																			{{ 'Add' | translate }}
																		</ion-button>
																	</div>
																</ion-col>
															</ion-row>
														</ion-col>
														<!-- <ion-col size="12" size-sm="12" size-md="12" size-xl="4">
															<ion-list-header class="ion-no-padding">
																<ion-label color="primary">{{'Vendor planning data' | translate}}</ion-label>
															</ion-list-header>
														</ion-col>
														<ion-col size="12" size-sm size-xl="4">
															<app-form-control
																[field]="{id: 'OrderMultiple', label: 'Order Multiple', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'MinimumOrderQty', label: 'Minimum Order Qty', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>
														</ion-col>
														<ion-col size="12" size-sm size-xl="4">
															<app-form-control
																[field]="{id: 'LeadTime', label: 'Lead Time', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>

															<app-form-control
																[field]="{id: 'ToleranceDays', label: 'Tolerance Days', type: 'number', form: formGroup}"
																(change)="saveItemInBranch();"
															>
															</app-form-control>
														</ion-col>
														<ion-col size="12" size-sm size-xl="12">
															<div class="safe-max-width">
																<app-data-table
																	class="box-shadow responsive"
																	[rows]="itemsPlaningData"
																	[trackBy]="'Id'"
																	[(selectedRows)]="selectedItems"
																	[showSpinner]="pageConfig.showSpinner"
																	[showFilter]="pageConfig.isShowSearch"
																	[(query)]="query"
																	(dataInfinite)="loadData($event)"
																	(filter)="onDatatableFilter($event)"
																	(sort)="onSort($event)"
																	(selectedRowsChange)="showCommandBySelectedRows($event)"
																>
																	<datatable-empty-message subMessage="Please click add new to start..." [showImg]="false" minHeight="125px">
																		<ng-template datatable-empty-message-template>
																			<ion-button (click)="addPlanningVendor()" size="small" fill="outline" *ngIf="pageConfig.canEdit">
																				<ion-icon slot="start" name="add-outline"></ion-icon>
																				{{ 'Add planning vendor' | translate }}
																			</ion-button>
																		</ng-template>
																	</datatable-empty-message>
																	<datatable-column [checkbox]="true" name=""></datatable-column>
																	<datatable-column
																		class="col-id"
																		name="IDVendor"
																		property="Id"
																		[navLink]="pageConfig.pageName"
																	></datatable-column>
																	<datatable-column class="col-name flex-break" name="Title" property="Name"></datatable-column>
																	<datatable-column class="col-code" name="Order interval" property="OrderInterval"></datatable-column>
																	<datatable-column class="col-code" name="Order multiple" property="OrderMultiple"></datatable-column>
																	<datatable-column class="col-code" name="Order multiple" property="OrderMultiple"></datatable-column>
																	<datatable-column class="col-code" name="MOQ" property="MinimumOrderQty"></datatable-column>
																	<datatable-column class="col-code" name="Lead time" property="LeadTime"></datatable-column>
																	<datatable-column class="col-code" name="Tolerance days" property="ToleranceDays"></datatable-column>
																</app-data-table>
															</div>
														</ion-col> -->
													</ion-row>
												</form>
											</ion-grid>
										</div>
									</div>
									<div id="inventory" *ngIf="segmentView.Page == 'Inventory'">
										<div class="table-contain" id="unit-specification">
											<section class="table" style="min-width: 1320px">
												<header class="bold" style="padding-right: 0">
													<div class="col-code cell">{{'Warehouse' | translate}}</div>
													<div class="col-code cell">{{'Storer' | translate}}</div>

													<div class="col-name cell">{{'Zone - Location' | translate}}</div>
													<div class="col-number cell">{{'Lot' | translate}}</div>
													<div class="col-number cell">{{'LPN' | translate}}</div>

													<div class="col-number cell">{{'OnHand' | translate}}</div>
													<div class="col-number cell">{{'Expected' | translate}}</div>
													<div class="col-number cell">{{'Allocated' | translate}}</div>
													<div class="col-number cell" *ngIf="isAdjust">{{'Qty Adjust' | translate}}</div>
													<div class="col-number cell" *ngIf="isAdjust">{{'Qty Target' | translate}}</div>
												</header>
												<div class="row" [ngClass]="{odd: j % 2 != 0 }" *ngFor="let i of Inventories; let j = index;">
													<div class="col-code cell">{{i.Warehouse}}</div>
													<div class="col-code cell">{{i.StorerName}}</div>
													<div class="col-name cell">{{i.ZoneName}} - {{i.LocationName}}</div>
													<div class="col-number cell">{{i.LotId}}</div>
													<div class="col-number cell">{{i.LPNId}}</div>
													<div class="col-number cell">{{i.QuantityOnHand}}</div>
													<div class="col-number cell">{{i.QuantityExpected}}</div>
													<div class="col-number cell">{{i.QuantityAllocated}}</div>
													<div class="col-number cell" *ngIf="isAdjust">
														<input
															[disabled]="!pageConfig.canEdit"
															(change)="calculateQtyAdjust(i)"
															[(ngModel)]="i.QtyAdjust"
															class="c-input"
															type="number"
															step="1"
															max="999999999999999999"
														/>
													</div>
													<div class="col-number cell" *ngIf="isAdjust">
														<input
															[disabled]="!pageConfig.canEdit"
															(change)="calculateQtyTarget(i)"
															[(ngModel)]="i.QtyTarget"
															class="c-input"
															type="number"
															step="1"
															max="999999999999999999"
														/>
													</div>
												</div>
											</section>
										</div>
									</div>
								</div>
							</ion-grid>
						</div>
					</div>
				</div>
			</ion-col>
		</ion-row>
	</ion-grid>
</ion-content>
